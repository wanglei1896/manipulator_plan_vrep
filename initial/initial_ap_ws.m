%% 在matlab本地初始化各along path规划数据
global  outputData ...
        inputData ...
        optimLog ...       %优化日志，算法优化过程中产生的信息（用于分析）
        %model           %机械臂的运动学模型

isTest=false;
fromVrep=false;
%%% 初始化
%model = model_ur5();
optimLog = optimLog_ap(4);   %优化有几个组
%{
inputData = input_ap([0.77068126,0.77309632,0.75121748,0.70708108,0.64506137,0.57133377,0.49313977,0.41797850,0.35329452,0.30551067,0.27931854,0.27690336,0.29878202,0.34291825,0.40493801,0.47866556,0.55685973,0.63202107,0.69670522,0.74448907,0.77068126;
                      0.15366602,0.23186007,0.30702132,0.37170541,0.41948923,0.44568133,0.44809639,0.42621762,0.38208121,0.32006153,0.24633414,0.16814020,0.092979006,0.028294884,-0.019489162,-0.045681395,-0.048096560,-0.026217796,0.017918654,0.079938300,0.15366602;
                      0.076850057,0.076850057,0.076850057,0.076850057,0.076850057,0.076850057,0.076850057,0.076850057,0.076850057,0.076850057,0.076850057,0.076850057,0.076850057,0.076850057,0.076850057,0.076850057,0.076850057,0.076850057,0.076850057,0.076850057,0.076850057
                      ], optimLog.group_num*10); %输入路径规范化后的采样段数
%}
inputData = input_ap([-12.20 ,44.48 ,137.29 
-17.91 ,45.00 ,141.29 
-24.82 ,45.89 ,145.04 
-33.09 ,47.26 ,148.37 
-42.84 ,48.99 ,151.19 
-53.97 ,50.78 ,153.34 
-65.99 ,52.17 ,154.69 
-78.01 ,52.67 ,155.12 
-89.00 ,52.08 ,154.58 
-98.26 ,50.61 ,153.13 
-105.62 ,48.79 ,150.88 
-111.27 ,47.09 ,147.99 
-115.75 ,45.75 ,144.60 
-112.99 ,44.99 ,141.36 
-106.33 ,44.61 ,138.08 
-100.53 ,44.53 ,134.39 
-95.54 ,44.78 ,130.38 
-91.25 ,45.35 ,126.08 
-87.54 ,46.21 ,121.53 
-83.85 ,46.55 ,120.05 
-79.50 ,46.14 ,121.96 
-74.83 ,45.85 ,123.43 
-69.88 ,45.66 ,124.42 
-64.72 ,45.57 ,124.92 
-59.41 ,45.57 ,124.91 
-54.07 ,45.66 ,124.40 
-48.76 ,45.84 ,123.40 
-43.59 ,46.14 ,121.92 
-38.62 ,46.56 ,119.98 
-33.91 ,47.13 ,117.61 
-29.48 ,47.84 ,114.84 
-25.37 ,48.73 ,111.69 
-21.56 ,49.79 ,108.17 
-18.87 ,49.36 ,109.63 
-16.50 ,48.10 ,114.00 
-13.81 ,47.03 ,118.08 
-10.76 ,46.18 ,121.84 
-7.30 ,45.52 ,125.24 
-3.37 ,45.06 ,128.27 
-7.31 ,44.63 ,132.83 
-12.16 ,44.59 ,137.21 
]'/180*pi,optimLog.group_num*10);

% 元循环，将上次优化的结果路径作为本次的目标路径
if ~isequal(outputData,[]) && ~isequal(outputData.endPath,[]) && isTest
    inputData=input_ap(outputData.endPath,20);
end
outputData = output_multiSeg();

%%% 默认
outputData.spacenum = optimLog.group_num*10;

%%% 从vrep中读取数据
if fromVrep
    vrep=remApi('remoteApi')'; % using the prototype file (remoteApiProto.m)
    fromVrep_ap;
end

if size(inputData.path,1)==3
    inputData.pStart = eye(4);
    inputData.pStart(1:3,4) = inputData.path(:,1);
    %inputData.qStart = model.ikunc(inputData.pStart);
end
